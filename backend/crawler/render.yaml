# Render Blueprint for Crawler Service
# ⚠️ WARNING: Crawler is resource-intensive and may violate LinkedIn ToS
# Docs: https://render.com/docs/blueprint-spec

services:
  - type: worker  # Background worker (not web service)
    name: linkedin-crawler
    runtime: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    region: singapore  # or oregon, frankfurt
    plan: starter  # ⚠️ FREE TIER NOT RECOMMENDED (too slow, will timeout)
    branch: main
    envVars:
      # LinkedIn Credentials (REQUIRED)
      - key: LINKEDIN_EMAIL
        sync: false  # Set manually in Render dashboard
      - key: LINKEDIN_PASSWORD
        sync: false  # Set manually in Render dashboard
      
      # Delays (Optional - defaults are fine)
      - key: MIN_DELAY
        value: 2.0
      - key: MAX_DELAY
        value: 5.0
      - key: PROFILE_DELAY_MIN
        value: 10.0
      - key: PROFILE_DELAY_MAX
        value: 20.0
      
      # Mode
      - key: USE_MOBILE_MODE
        value: false
      - key: RENDER
        value: true  # Enable headless mode
      - key: DOCKER
        value: true
      
      # RabbitMQ (REQUIRED)
      - key: RABBITMQ_HOST
        sync: false  # Your RabbitMQ host
      - key: RABBITMQ_PORT
        value: 5672
      - key: RABBITMQ_USER
        value: guest
      - key: RABBITMQ_PASS
        sync: false
      - key: RABBITMQ_QUEUE
        value: linkedin_profiles
      
      # Scoring Queue
      - key: SCORING_QUEUE
        value: scoring_queue
      - key: DEFAULT_REQUIREMENTS_ID
        value: desk_collection
    
    autoDeploy: false  # Manual deploy only (to avoid accidental runs)

# ============================================================================
# IMPORTANT NOTES:
# ============================================================================
# 
# 1. COST WARNING:
#    - Crawler uses ~1-2 GB RAM + high CPU
#    - FREE TIER will be too slow (timeouts)
#    - STARTER ($7/month) minimum recommended
#    - Could cost $20-50/month if running 24/7
# 
# 2. LINKEDIN ToS:
#    - Automated scraping violates LinkedIn Terms of Service
#    - Your LinkedIn account may be suspended
#    - Render may suspend your account if detected
# 
# 3. ALTERNATIVES:
#    - Run crawler on local machine or VPS
#    - Use LinkedIn Official API (limited but legal)
#    - Use manual data collection
# 
# 4. RABBITMQ:
#    - You need external RabbitMQ service
#    - Options:
#      a) CloudAMQP (free tier: 1M messages/month)
#      b) Render Redis (as alternative queue)
#      c) Self-hosted on VPS
# 
# 5. RATE LIMITING:
#    - Limit to 10-20 profiles/hour max
#    - Use longer delays (30-60s between profiles)
#    - Rotate IP addresses if possible
# 
# ============================================================================
